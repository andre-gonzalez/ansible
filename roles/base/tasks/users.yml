---
- name: create frank group
  tags:
    - full-install
    - light-install
    - users
  ansible.builtin.group:
    name:
      - frank
    state: present

- name: Create ansible group
  tags:
    - full-install
    - light-install
    - users
  ansible.builtin.group:
    name:
      - ansible
    state: present

- name: Set fact for Debian
  set_fact:
    sudo_group: sudo
  when: ansible_os_family == "Debian"

- name: Set fact for ArchLinux
  set_fact:
    sudo_group: wheel
  when: ansible_os_family == "Archlinux"

- name: users | frank | create user
  tags:
    - full-install
    - light-install
    - users
  user:
    name: frank
    group: frank
    groups: adm,{{ sudo_group }}
    state: present
    # password: "{{ frank_passwd }}"
    shell: /bin/fish

- name: create ansible user
  tags:
    - full-install
    - light-install
    - users
    - ansible
  ansible.builtin.user:
    name: ansible
    system: true
  become: true

- name: copy sudoers_ansible
  tags:
    - full-install
    - users
    - ansible
    - light-install
  ansible.builtin.copy: src={{ item.src }} dest={{ item.dest }}
  with_items:
    - { src: 'sudoers_ansible', dest: '/etc/sudoers.d/ansible', mode: 0440 }
    - { src: 'sudoers_frank', dest: '/etc/sudoers.d/frank', mode: 0440 }
  become: true
