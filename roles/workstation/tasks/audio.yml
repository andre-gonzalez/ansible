---
- name: Install pulseaudio packages
  tags:
    - full-install
    - light-install
    - pulseaudio
  ansible.builtin.package:
    name:
      - pulseaudio
      - alsa-utils
      - pavucontrol
      - pulseaudio-bluetooth
      - pulseaudio-alsa
    state: present
  become: true
  notify: "restart pulseaudio"

- name: Set pulseaudio to automatically change to the bluetooth once connected
  tags:
    - full-install
    - light-install
    - pulseaudio
  ansible.builtin.lineinfile:
    path: /etc/pulse/default.pa
    line: 'load-module module-switch-on-connect'
    create: yes
    backrefs: true
    state: present
  become: true

- name: Install pipewire packages
  tags:
    - pipewire
    - never
  ansible.builtin.package:
    name:
      - alsa-utils
      - pavucontrol # Audio control interface
      - lib32-pipewire
      - pipewire-alsa # Rounte all application using ALSA API through pipewire
      - pipewire-docs # Not necessary. Only documentation
      - wireplumber # Session manager. Alternative to pipewire-media-session
      - qpwgraph  # GUI session manager
      - pipewire-pulse
      - pipewire-jack
      - lib32-pipewire-jack
      - pipewire-audio
      - pipewire
    state: present
  become: true
